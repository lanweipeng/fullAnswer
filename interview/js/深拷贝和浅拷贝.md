```js
const arr1 = [1, 2];
const arr2 = arr1;
arr2[1] = 3;
arr1; //[1,3]
arr2; //[1,3]
```

å¯¹å¼•ç”¨ç±»å‹è¿›è¡Œèµ‹å€¼ï¼Œå‘ç°ä¸€æ—¦ä¸€æ–¹æ”¹å˜ï¼Œå¦ä¸€æ–¹ä¹Ÿä¼šæ”¹å˜ï¼Œä¹‹æ‰€ä»¥ä¼šäº§ç”Ÿè¿™ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å› ä¸ºç­‰å·èµ‹å€¼åªèƒ½èµ‹å€¼å¼•ç”¨ç±»å‹çš„åœ°å€ã€‚äºæ˜¯å‡ºç°æµ…æ‹·è´ï¼Œé‚£å¦‚ä½•å®ç°ï¼Œæ–¹æ³•å°±å¤ªå¤šäº†ï¼Œè‡³å°‘è¦è®°ä½ä¸‰ä¸ª

æ•°ç»„

```js
arr2 = [...arr1];
arr2 = arr1.concat();
arr2 = arr1.slice();
arr2 = Object.assign([], arr1);
arr2 = Array.from(arr1);
arr2 = arr1.map((item) => item);
```

å¯¹è±¡

```js
obj2 = { ...obj1 };
obj2 = Object.assign({}, obj1);
```

for in

```js
obj2 = cloneShalow(obj1);
function cloneShalow(obj) {
  const res = Array.isArray(obj) ? [] : {};
  for (let key in obj) {
    if (obj.hasOwnProperty(key)) {
      res[key] = obj[key];
    }
  }
  return res;
}
```

ä½†æ˜¯å¦‚æœ item æ˜¯å¼•ç”¨ç±»å‹ï¼Œé‚£ä¹ˆæµ…æ‹·è´å°±è§£å†³ä¸äº†äº†ï¼Œè¿™æ—¶å€™å°±å¾—ç”¨æ·±æ‹·è´

æ–¹æ³•ä¸€ï¼šJSON.parse(JSON.stringify(obj))  
`const b=JSON.parse(JSON.stringify(a))`  
ç¼ºé™·ï¼š

- ä¼šå¿½ç•¥ undefinedã€symbolã€mapã€setã€weakMapã€weakSet
- å‡½æ•°(å¿½ç•¥)ã€æ—¥æœŸ(å˜æˆå­—ç¬¦ä¸²)ã€æ­£åˆ™å¯¹è±¡(å˜æˆç©ºå¯¹è±¡)éƒ½ä¼šå‡ºç°é—®é¢˜
- ä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„å¯¹è±¡

æ–¹æ³•äºŒï¼šMessageChannel

```js
function structralClone(obj) {
  return new Promise((resolve) => {
    const { port1, port2 } = new MessageChannel();
    port2.onmessage = (ev) => resolve(ev.data);
    port1.postMessage(obj);
  });
}
var a = { b: new RegExp(/[1-9]/) };
// a.self = a;
(async () => {
  const b = await structralClone(a);
  console.log(b);
})();
```

ç¼ºç‚¹ï¼š

- å¯¹æ€§èƒ½æœ‰å½±å“
- æ‹·è´çš„å¯¹è±¡æœ‰å‡½æ•°ä¼šæŠ¥é”™
- æ—¥æœŸä¼šå˜æˆå­—ç¬¦ä¸²
  ä¼˜ç‚¹ï¼š
- èƒ½è§£å†³å¾ªç¯å¼•ç”¨
  æ–¹æ³•ä¸‰ï¼šlodash çš„æ·±æ‹·è´å‡½æ•°(æ€§èƒ½æœ€å¥½ï¼Œä½†å¤„ç†ä¸äº† WeakMap å’Œ WeakSetï¼Œç”±äºåº“çš„è®¾å®šï¼Œæ‹·è´çš„å¯¹è±¡åµŒå¥—ä¸èƒ½è¶…è¿‡å››å±‚)
  æ–¹æ³•å››ï¼šè‡ªå®šä¹‰æ·±æ‹·è´å‡½æ•°ï¼ˆå¸¸è€ƒæ‰‹å†™ï¼‰

```js
function cloneDeep(source, map = new WeakMap()) {
  if (map.get(source)) {
    return map.get(source);
  }
  //åŸºç¡€æ•°æ®ç±»å‹
  if (typeof source !== "object" || source == null) {
    return source;
  }
  //ç‰¹æ®Šå¯¹è±¡
  const types = [Date, Map, Set, RegExp];
  if (types.includes(source.constructor)) return new source.constructor(source);

  const res = new source.constructor();
  map.set(source, res);

  for (let key in source) {
    if (source.hasOwnProperty(key)) {
      res[key] = cloneDeep(source[key], map);
    }
  }

  //å¤„ç†symbolä½œä¸ºå¯¹è±¡å±æ€§çš„æƒ…å†µ
  const symbolKeys = Object.getOwnPropertySymbols(source);
  for (const symKey of symbolKeys) {
    res[Symbol(symKey.description)] = cloneDeep(source[symKey]);
  }
  return res;
}
```

æ–¹æ³•äº” structuredClone

- æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜
- functionã€WeakMapã€WeakSetã€Symbol ä¼šæŠ¥é”™

å…·ä½“è¿‡ç¨‹å¯ä»¥çœ‹æˆ‘å¦ä¸€ç‰‡æ–‡ç« [æ‰‹å†™æ·±æ‹·è´ï¼Œä½ å†™å…¨äº†å—](https://juejin.cn/post/7273427487589236797)

## å‚è€ƒ

- [[javascript æ ¸å¿ƒ-15] æ‰‹å†™å®Œç¾æ·±æ‹·è´ä»£ç å®ç° ğŸŒ](https://juejin.cn/post/7247278895338913851?searchId=2023082916334189BDFEFFB35EBCACA828)
- [2 å‘¨åˆ·å®Œ 100 é“å‰ç«¯ä¼˜è´¨é¢è¯•çœŸé¢˜](https://coding.imooc.com/learn/list/562.html)
